---
import MainLayout from '../layouts/MainLayout.astro';
import { getCollection } from 'astro:content';
import BlogPostCard from '../components/BlogPostCard.astro';
import '../styles/global.css';

// 1. Get all posts from the 'blog' collection
const allPosts = await getCollection('blog');

// 2. Sort them so the newest post is first
const sortedPosts = allPosts.sort(
    (a, b) => new Date(b.data.pubDate).valueOf() - new Date(a.data.pubDate).valueOf()
);
---
<MainLayout 
    title="TechBrew Daily - Your Daily Tech News" 
    description="The latest news, reviews, and insights in the world of technology, gadgets, and AI."
>
    <h1 class="text-4xl font-bold mb-8 text-cyan-400">Latest Posts</h1>

    <!-- 3. Create a list and loop through the sorted posts -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {sortedPosts.map(post => (
            <BlogPostCard post={post} />
        ))}
    </div>
</MainLayout>